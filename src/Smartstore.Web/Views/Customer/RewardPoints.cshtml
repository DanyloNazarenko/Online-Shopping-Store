@using Smartstore.Web.Models.Customers
@using Smartstore.Utilities.Html

@model CustomerRewardPointsModel

@{
    Assets.AppendTitleParts(T("PageTitle.Account"));

    Layout = "_MyAccount";
    ViewBag.PageClassToken = "rewardpoints";
    ViewBag.PageTitle = T("Account.RewardPoints").Value;

    // TODO: (wcag) (mg) Create an extension or utility method for this somewhere and apply it everywhere (e.g. Wallet).
    // TODO: (wcag) (mg) Add a Left-to-Right Mark (U+200E) to prevent the digit and sign from being torn apart or the sign being displayed on the right.
    // Do not use hyphens as a sign, as these are not recognized by screen readers.
    IHtmlContent ToHtmlNumber(decimal value)
    {
        return new HtmlString(value < 0
            ? "&minus;" + Math.Abs(value).ToString("N0", CultureInfo.CurrentCulture)
            : value.ToString("N0", CultureInfo.CurrentCulture));
    }
}

<div class="alert alert-info" role="status" aria-live="polite">
    @Model.RewardPointsBalanceFormatted
</div>

<fieldset class="content-group mt-4">
    <legend class="mb-0"><span>@T("RewardPoints.History")</span></legend>
    <div class="reward-points-history">
        @if (Model.RewardPoints.Count == 0)
        {
            <div class="alert alert-warning mt-3">
                @T("RewardPoints.NoHistory")
            </div>
        }
        else
        {
            <div class="table-responsive">
                <table class="table table-striped table-hover">
                    <caption class="sr-only">@T("RewardPoints.History")</caption>
                    <thead>
                        <tr>
                            <th class="border-top-0" scope="col">
                                @T("Common.CreatedOn")
                            </th>
                            <th class="border-top-0 text-center" scope="col">
                                @T("RewardPoints.Fields.Points")
                            </th>
                            <th class="border-top-0 text-center" scope="col">
                                @T("RewardPoints.Fields.PointsBalance")
                            </th>
                            <th class="border-top-0" scope="col">
                                @T("RewardPoints.Fields.Message")
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach(var item in Model.RewardPoints)
                        {
                            <tr>
                                <td>
                                    <time datetime="@item.CreatedOn.ToIso8601String()">@item.CreatedOn.ToNativeString()</time>
                                </td>
                                <td class="text-center">
                                    @ToHtmlNumber(item.Points)
                                </td>
                                <td class="text-center">
                                    @ToHtmlNumber(item.PointsBalance)
                                </td>
                                <td dir="auto">@item.Message</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
    </div>
</fieldset>